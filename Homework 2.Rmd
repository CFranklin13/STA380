---
title: "Exercise 2"
author: "Clarissa Franklin, Yannick Heard, & Paige Mckenzie"
date: "August 13, 2017"
output: html_document
---


You can also embed plots, for example:

### First, we read in the raw file directly from github and import the ggplot2 library
```{r, echo=FALSE, message=FALSE, warning=FALSE}
ABIA <- read.csv("https://raw.githubusercontent.com/jgscott/STA380/master/data/ABIA.csv", header=TRUE)
library(ggplot2)
```

We can look at the different variables available to us is this data set. Remove cancelled flights. Separate into flights departing from Austin and flights arriving in Austin.
```{r, echo=FALSE, message=FALSE, warning=FALSE}

library(lubridate)
names(ABIA)
ABIA$MonthName <- month(ABIA$Month, label=TRUE, abbr=FALSE)
ABIA$MonthName <-factor(ABIA$MonthName)
```

This data set contains flights into and out of Austin. Let's create a column for Weekday name to make the data more understandable, then We can separate this data into two subsets: flights arriving into Austin, and flights departing from Austin.

```{r, echo=FALSE, message=FALSE, warning=FALSE}
departures <- ABIA[(ABIA$Origin=="AUS") & ABIA$Cancelled==0,]
arrivals <- ABIA [(ABIA$Dest == "AUS") & ABIA$Cancelled==0,]
```

We can take a look at the summary statistics to start to understand our data.

```{r, echo=FALSE, message=FALSE, warning=FALSE}
cat("Summary statistics: flights departing from Austin\n\n")
summary(departures)

cat("\n\nSummary statistics: flights arriving in Austin\n\n")
summary(arrivals)
```

```{r, echo=FALSE, message=FALSE, warning=FALSE}

qplot( departures$DepDelay, departures$ArrDelay, xlab="Departure Delay (min)", ylab="Arrival Delay (min)", main="Austin-Bergstrom Departures")

```

### Create a historgram for average arrival and departure delays

```{r, echo=FALSE, message=FALSE, warning=FALSE}
print(hist(ABIA$ArrDelay, plot=TRUE, xlim=c(-30,300), freq=FALSE, breaks=seq(-180,1800,15)))
print(hist(ABIA$DepDelay, plot=TRUE, xlim=c(-30,300), freq=FALSE, breaks=seq(-180,1800,15)))
```


## aggregate (group) the flight data by month and take the mean

```{r, echo=FALSE, message=FALSE, warning=FALSE}

arrivals_agg <- aggregate(.~Month, data=arrivals, mean, na.rm=TRUE, na.action=NULL)
#print(arrivals_agg)

departures_agg <- aggregate(.~Month, data=departures, mean, na.rm=TRUE, na.action=NULL)

ggplot() +
  geom_line(data=arrivals_agg, aes(x=Month, y=ArrDelay, colour="Arrival Delay: Incoming Flights", label="ArrDelay: Incoming Flights")) +
  geom_line(data=arrivals_agg, aes(x=Month, y=DepDelay, colour="Departure Delay: Incoming Flights", label="DepDelay: Incoming Flights"))+
  geom_line(data=departures_agg, aes(x=Month, y=ArrDelay, colour="Arrival Delay: Outgoing Flights", label="ArrDelay: Outgoing Flights")) +
  geom_line(data=departures_agg, aes(x=Month, y=DepDelay, colour="Departure Delay: Outgoing Flights", label="DepDelay: Outgoing Flights"))+
  scale_color_manual(values=c("cyan4", "blue", "orchid", "orangered4")) + scale_x_continuous("Month", limits=c(1,12), breaks=c(1,2,3,4,5,6,7,8,9,10,11,12))+
  scale_y_continuous("Average Delay (min)")+labs(title="Austin-Bergstrom Delays by Month")
```

```{r, echo=FALSE, message=FALSE, warning=FALSE}

arrivals_agg <- aggregate(.~DayOfWeek, data=arrivals, mean, na.rm=TRUE, na.action=NULL)
#print(arrivals_agg)

departures_agg <- aggregate(.~DayOfWeek, data=departures, mean, na.rm=TRUE, na.action=NULL)

#print(departures_agg)

ggplot() +
  geom_line(data=arrivals_agg, aes(x=DayOfWeek, y=ArrDelay, colour="Arrival Delay: Incoming Flights", label="ArrDelay: Incoming Flights")) +
  geom_line(data=arrivals_agg, aes(x=DayOfWeek, y=DepDelay, colour="Departure Delay: Incoming Flights", label="DepDelay: Incoming Flights"))+
  geom_line(data=departures_agg, aes(x=DayOfWeek, y=ArrDelay, colour="Arrival Delay: Outgoing Flights", label="ArrDelay: Outgoing Flights")) +
  geom_line(data=departures_agg, aes(x=DayOfWeek, y=DepDelay, colour="Departure Delay: Outgoing Flights", label="DepDelay: Outgoing Flights"))+
  scale_color_manual(values=c("cyan4", "blue", "orchid", "orangered4")) + scale_x_continuous("Day of Week", limits=c(1,7))+
  scale_y_continuous("Average Delay (min)")+labs(title="Austin-Bergstrom Delays by Day of Week", subtitle="1 (Monday) - 7 (Sunday)")
```


```{r, echo=FALSE, message=FALSE, warning=FALSE}

arrivals_agg <- aggregate(.~DayofMonth, data=arrivals, mean, na.rm=TRUE, na.action=NULL)
#print(arrivals_agg)

departures_agg <- aggregate(.~DayofMonth, data=departures, mean, na.rm=TRUE, na.action=NULL)

#print(departures_agg)

ggplot() +
  geom_line(data=arrivals_agg, aes(x=DayofMonth, y=ArrDelay, colour="Arrival Delay: Incoming Flights", label="ArrDelay: Incoming Flights")) +
  geom_line(data=arrivals_agg, aes(x=DayofMonth, y=DepDelay, colour="Departure Delay: Incoming Flights", label="DepDelay: Incoming Flights"))+
  geom_line(data=departures_agg, aes(x=DayofMonth, y=ArrDelay, colour="Arrival Delay: Outgoing Flights", label="ArrDelay: Outgoing Flights")) +
  geom_line(data=departures_agg, aes(x=DayofMonth, y=DepDelay, colour="Departure Delay: Outgoing Flights", label="DepDelay: Outgoing Flights"))+
  scale_color_manual(values=c("cyan4", "blue", "orchid", "orangered4")) + scale_x_continuous("Day of Month", limits=c(1,31))+
  scale_y_continuous("Average Delay (min)")+labs(title="Austin-Bergstrom Delays by Day of Month")
```

